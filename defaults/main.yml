---

# Configuration file related variables
# - By default this role Writes configuration to /etc/mysql/my.cnf
#   (Ubuntu) or /etc/my.cnf (RedHat) (ref. vars/ directory files),
#   (backwards compatibility with old deployments)
# - For newer percona releases it is recommended to define the
#   variables in host_vars as suggested below (i.e., avoid writing
#   config directly to my.cnf and instead use the include dirs)
# - Ref.
#     https://askubuntu.com/questions/1283364/mysql-my-cnf-and-etc-alternatives
#     https://serverfault.com/questions/954304/mysql-8-on-ubuntu-whats-the-difference-between-etc-mysql-conf-d-and-etc-mys
#
# - Suggested values:
#   Ubuntu:
# mysql_config_file_template: "etc/mysql/mysql.conf.d/z-config-via-ansible.cnf.j2"
# mysql_config_file: /etc/mysql/mysql.conf.d/z-config-via-ansible.cnf
#   RedHat:
# mysql_config_file_template: "etc/my.cnf.d/z-config-via-ansible.cnf.j2"
# mysql_config_file: "/etc/my.cnf.d/z-config-via-ansible.cnf"



# Version to install, defaulting to 5.6
# - Although 5.6 is already in ES(Extended Support) phase, to prevent issues 
#   with existing installations, do not increase default version for now
#   (to avoid potentially breaking the target on a redeploy, because some
#    distros require a purge of old Percona pkgs before installing a new version)
# - For Ubuntu >= 20.04: set default to 5.7 (because 5.6 packages do not exist)

mysql_version_major: "5"
mysql_version_minor: "{% if ansible_distribution == 'Ubuntu' and ansible_distribution_major_version|int >=20 %}7{% else %}6{% endif %}"
mysql_version: "{{ mysql_version_major|int }}.{{ mysql_version_minor|int }}"

# Basic settings
mysql_root_password: "pass"
mysql_port: "3306"
mysql_bind_address: "127.0.0.1"
mysql_language: "/usr/share/mysql/"
mysql_datadir: "/var/lib/mysql"

# Fine tuning
mysql_key_buffer: "16M"
mysql_max_allowed_packet: "256M"
mysql_thread_stack: "192K"
mysql_cache_size: "8"
mysql_myisam_recover: "BACKUP"
mysql_max_connections: "500"
mysql_table_cache: "64"
mysql_thread_concurrency: "10"
mysql_query_cache_limit: "1M"
mysql_query_cache_size: "16M"
mysql_character_set_server: "utf8"
mysql_collation_server: "utf8_general_ci"
mysql_mysqldump_max_allowed_packet: "128M"
mysql_isamchk_key_buffer: "16M"
mysql_sort_buffer_size: "256K"

# InnoDB tuning
mysql_innodb_file_per_table: "1"
mysql_innodb_flush_method: "fdatasync"
mysql_innodb_buffer_pool_size: "256M"
mysql_innodb_flush_log_at_trx_commit: "1"
mysql_innodb_lock_wait_timeout: "50"
mysql_innodb_log_buffer_size: "1M"
mysql_innodb_log_file_size: "64M"

mysql_character_set_client_handshake: "FALSE"

mysql_timezone_info: "false"

mysql_databases: []
mysql_users: []

install_rpm_repositories: "true"

# To disable log_bin in percona >=8, enabled by default
mysql_disable_log_bin: "true"

# Default Auth Plugin
# used in templates when Percona Server >= 5.7
mysql_default_authentication_plugin: "mysql_native_password"
